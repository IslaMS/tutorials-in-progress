---
layout: post
title: Getting Started with Shiny
subtitle: Creating interactive web apps using the R language
date: 2016-11-25T16:00:00.000Z
author: John
meta: Shiny
---

<div class="block">
  <center>
  <img src="{{ site.baseurl }}/img/tutheader_shiny.jpg" alt="Img">
</center>
</div>

# Tutorial Aims:

- What is Shiny?
- Learn the structure of a Shiny App
- Recreate a Shiny App
- Create your own Shiny App

# Steps:

## [1\. Download Shiny](#download)

## [2\. The Shiny app file structure](#structure)

## [3\. The Shiny app.R layout](#layout)

## [4\. Creating a Shiny app](#create)

## [5\. Exporting a finished app](#export)

--------------------------------------------------------------------------------

At it's core, Shiny is merely an R package like `dplyr` or `ggplot2`. The package is used to create web-applications, but uses the R language rather than javascript, HTML5, or CSS, which are traditionally used for web applications. By using R, Shiny provides an efficient method of creating web applications designed around data presentation and analysis.

If you're unsure what a web-app is, look at this [gallery](http://shiny.rstudio.com/gallery/) of basic apps made using Shiny.

## What are Shiny Apps useful for?

- Exploring data
- Teaching others
- Engaging with the public
- Giving presentations
- Looking clever!

[]()

## Downloading Shiny

To get Shiny in RStudio the first thing you need is the `shiny` package, which you can get from [CRAN](https://cran.r-project.org/web/packages/shiny/index.html):

```r
install.packages("shiny")
```

[]()

## The Shiny app file structure

Next, select _File -> New File -> Shiny Web App..._, give the application a descriptive name and change the Application type to "_Single File (app.R)_", save the app in an appropriately named directory and click _Create_.

RStudio generates a template R script called `app.R`.

Notice that the name given to your app was assigned to the directory, not the app script. For your app to work, the file must remain named `app.R`.

It's possible to create a Shiny app with two files called `ui.R` and `server.R`, but the same can be accomplished by using one file. This tutorial will assume you have the one file app structure.

Local data for your app needs to be stored in a directory called `Data` inside your app directory. When importing the data for use by `app.R` use the full file path, e.g.:

```r
data <- read.csv ("./Data/data.csv")
```

To add images to your shiny app, add them to a directory called `www` inside your app directory. Pull the images in the app by adding:

```r
img(src="<file name>")
```

to the `ui` object in `app.R` wherever you want your file to appear.

remember to include the file extension (e.g. `.jpg`) in your file name.

For example, to include an image (`A.jpg`) in the main panel of your app (`mainPanel`):

```r
ui <- fluidPage(
    titlePanel("TITLE"),
    sidebarLayout(
        sidebarPanel(),
        mainPanel(
            img(src="A.jpg")
        )
    )
)
```

To review, a shiny application requires a specific directory structure to work properly, e.g.:

![Img]({{ site.baseurl }}/img/Dir_Screenshot.jpg)

[]()

## app.R layout

A basic `app.R` file consists of these parts:

- A section at the top of the script, loading any packages needed for the app to run, `shiny` is required at the very least but others like `dplyr` or `ggplot2` could be added when they are needed:

  ```r
  library(shiny)
  ```

- An object called `ui` which contains information about the layout of the app as it appears in your web browser. `fluidPage()` defines a layout that will resize according to the size of the browser window, all the app code will be placed within the brackets.

  ```r
  ui <- fluidPage()
  ```

- An object called `server` which contains information about the computation of the app, creating plots, tables, new objects using information provided by the user. All the app code will be placed within the curly brackets.

  ```r
  server <- function(input, output) {}
  ```

- A command to run the app, this should be included at the end of every shiny app. It tells shiny that the user interface comes from the object called `ui` and that the server information (data, plots etc.) comes from the object called `server`.

  ```r
  shinyApp(ui = ui, server = server)
  ```

Create a basic shiny app by copying the bits of code above into your `app.R`, delete any example code generated when you created the file.

## Layout of a Shiny App

Shiny apps are structured using panels, which are laid out in different arrangements. Panels can contain text, widgets, plots, tables, images, etc.

Below are some examples of panel layouts and the code that creates them:

**_INSERT SLIDESHOW OF SHINY LAYOUTS_**

[]()

## Creating a Shiny App - Basic Syntax

To illustrate how to code a Shiny app, we will emulate an app that I wrote to explore some data on the productivity of Barley genotypes.

Open up the finished web app and have a look at it by entering this in RStudio:

```r
library(shiny)
runGitHub(repo = "CC-11-Shiny", username = "ourcodingclub", subdir = "Example_App")
```

The app should then open in your browser.

Looking at the app, we can see that the app has a `sidebarLayout` with a `sidebarPanel`, `mainPanel` and `titlePanel`. It uses `selectInput` to choose the genotype of barley shown in thehistogram, and the colour of the histogram, a `sliderInput` to choose the number of bins in the histogram, and a `textInput` to display some text in the app. The histogram is located in the `mainPanel` along with a table of the data being shown, while the inputs are in the `sidebarPanel`.

To re-create this app, first create an `app.R`, then we can make our basic app structure which we will fill later:

```r
library(shiny)

ui <- fluidPage(
  titlePanel(),
  sidebarLayout(
    sidebarPanel(),
    mainPanel()
  )
)

server <- function(input, output) {}

runApp(ui = ui, server = server)
```

`titlePanel()` indicates that we would like a separate panel at the top of the page in which we can put the title.

`sidebarLayout()` indicates that we want our shiny app to have the side bar layout, one of many layouts we saw above. Within `sidebarLayout` we have:

- `sidebarPanel()`, which indicates that we want a sidebar panel included in our app. Sidebar panels often contain input widgets like sliders, text input boxes, radio buttons etc.
- `mainPanel()`, which indicates that we want a larger main panel. Main panels often contain the output of the app, whether it is a table, map, plot or something else.

### Input widgets

Now that we have our basic structure we can start to fill it with inputs and outputs.

The example app has four input widgets, a `selectInput` for genotype, a `selectInput` for histogram colour, a `sliderInput` for number of bins, and a `textInput` to add some text. Each of these widgets provides information on how to display the outputs, the histogram and its accompanying table. In the example app, all the widgets are found in the `sidebarPanel` so the code for these widgets should be put in the `sidebarPanel` command:

```r
library(shiny)

ui <- fluidPage(
  titlePanel(),
  sidebarLayout(
     sidebarPanel(
                   selectInput(inputId = "gen", label = "1\. Select genotype", choices = c("A" = "a","B" = "b","C" = "c","D" = "d","E" = "e","F" = "f","G" = "g","H" = "h"), selected = "a"),
                   selectInput(inputId = "col", label = "2\. Select histogram colour", choices = c("blue","green","red","purple","grey"), selected = "grey"),
                   sliderInput(inputId = "bin", label = "3\. Select number of histogram bins", min=1, max=25, value= c(10)),
                   textInput(inputId = "text", label = "4\. Enter some text to be displayed", "")),
      mainPanel()
  )
)

server <- function(input, output) {}

runApp(ui = ui, server = server)
```

Spend a couple of minutes looking at this code so you understand what it means, then enter into your own `app.R`.

Let's break down `selectInput()` to understand what is going on:

- `inputId = "gen"` gives this input the name `gen` whic iwill become useful when referencing this input later in the app script.
- `label = "1\. Select genotype"` gives this input a label to be displayed above it in the app.
- `choices = c("A" = "a","B" = "b", ...` gives a list of choices to be displayed in the dropdown menu (`A, B, etc.`) and the value that is actually gathered from that choice for use in the output (`a, b, etc.`).
- `selected = "grey"` gives the value from the dropdown menu that is selected by default.

The arguments presented by the other input widgets can be investigated using `?textInput`for example, in the R console.

#### More Input Widgets

There are plenty of pre-made widgets in Shiny, here is a selection each with the minimum number of arguments needed to render when running the app:

```r
actionButton(inputId = "action", label = "Go!")
```

```r
radioButtons(inputId = "radio", label = "Radio Buttons", choices = c("A", "B"))
```

```r
selectInput(inputId = "select", label = "select", choices = c("A", "B"))
```

```r
sliderInput(inputId = "slider", label = "slider", value = 5, min = 1, max = 100)
```

Notice how all of the inputs require an `inputId` and a `label` argument.

### Running a Shiny App

Take this opportunity to preview your app, click _Run App_:

![Img]({{ site.baseurl }}/img/Run_App_Screenshot.jpg)

or use the keyboard shortcut `Cmd + Opt + R` (Mac), `Ctrl + Alt + R` (Windows).

When a Shiny app is running in RStudio, the console cannot be used. To stop the app, click the _Stop_ button in the top right of the console window or press the `Esc` key.

![Img]({{ site.baseurl }}/img/Stop_Screenshot.jpg)

### Output

A shiny app without any outputs is useless. Outputs can be in the form of plots, tables, or text.

Coding an output is the same as in a normal R script.

As per our example, we're going to be using `ggplot()` to create a histogram.

Outputs are created by placing code in the curly brackets in the `server` object:

```r
server <- function(input, output) {
  output$plot <- renderPlot(ggplot(Barley, aes(x = yield)) +
  geom_histogram(bins = 7,
    fill = "grey"
    data = Barley)
  )                                                       
}
```

Look at the code above for a couple of minutes to understand what is going on, then copy and paste into your own `app.R`.

Basically, we are creating an object called `output$plot` and using `renderPlot()` to wrap a `ggplot()` call.

#### Reactive output

The histogram is great, but not particularly interactive. We need to link our input widgets to our output object.

For example, we want to select individual genotypes to display in our histogram which the user can select using the `selectInput` that we called `gen` earlier. Use some base R wizardry, `[]` `$` and `==` to select the data we want:

```r
server <- function(input, output) {
  output$plot <- renderPlot(ggplot(Barley, aes(x = yield)) +
  geom_histogram(bins = 7,
      fill = "grey",
      data=Barley[Barley$gen == input$gen,]
  )
  )                                                       
}
```

`data = Barley[Barley$Genotype == input$select,]` tells `geom_histogram()` to only use data where the value in column `gen` is equal to (`==`) the value given by `input$gen`. Note the `,` after `input$gen` which indicates that we are selecting columns, and that all the rows should be selected.

Next, we want to be able to change the colour of the histogram based on the value of the `selectInput` called `col`. To do this simply change fill = "grey" to `fill = input$col`:

Lastly we want to select the number of bins in the histogram using the `sliderInput` called `bin`. Simply change `bins = 7` to `bins = input$bin`:

```r
server <- function(input, output) {
  output$plot <- renderPlot(ggplot(Barley, aes(x = yield)) +
  geom_histogram(bins = input$bin,
               fill = input$col,
               data=Barley[Barley$gen == input$gen,]
  )
  )                                                       
}
```

### Additional elements

#### HTML

To make your app look more pretty, you can add HTML tags like in a normal HTML webpage. Below is a table of basic HTML tags, their shiny equivalent, and a description of what they do:

HTML    | shiny                                | Function
------- | ------------------------------------ | ----------------------------------------
`<div>` | `div()`                              | Defines a block with the same formatting
`<br>`  | `br()`                               | Inserts a break
`<hr>`  | `hr()`                               | Inserts a horizontal line
`<p>`   | `p()`                                | Creates a paragraph of text
`<a>`   | `a(href = "LINK", "displayed text")` | Creates a clickable link

a list of all HTML tags can be found using:

```r
shiny::tags
```

some tags may conflict with other functions and so you should explicitly state the source the function comes from, e.g.:

```r
tags$div()
```

Tags can be stacked to apply many arguments to the same object/text, just as in HTML:

```r
tags$div(style="color:red",
  tags$p("Visit us at:"),
  tags$a(href = "http://ourcodingglub.github.io", "Coding Club")
```

This creates a block of text that is coloured red (`style="color:red"`), within that block there is a paragraph of text (`tags$p("Visit us at?:")`) and a link (`tags$a(href = "http://ourcodingglub.github.io", "Coding Club")`).

For more information on the arguments that can be included in popular Shiny HTML tags, RStudio have a nice wiki at <https://shiny.rstudio.com/articles/tag-glossary.html>.

[]()

### Exporting a finished app

It is easy to send a shiny app to somebody else who also has RStudio. app.R can be sent alongside any data and other resources in a zip file to be unzipped by the recipient and run through R.

If you want to share the app over the internet I recommend using [Gist](gist.github.com), a part of Github which allows quick and messy sharing of code, you can quickly upload your app, share a link with others, or edit the file.

In gist.github.com, sign in with your account details and copy your app code into the large box provided. Name the file `app.R` and add another file called `readme.md` containing a quick explanation of the content of your app.

Select _Create public gist_ to publish the app. To send the app to another person, click the _Embed_ dropdown and select _Share_ from the dropdown menu, then copy the url that appears in the adjacent box.

![Img]({{ site.baseurl }}/img/Gist_Screenshot.jpg)

This url can be sent to anybody to run the app using R. To test it out, open a new R session and enter:

```r
library(shiny)
runGist("URL")
```

replacing `URL` with the copied gist url.

# Tutorial outcomes:
- to be added if needed 
